<div class="px-3">
  <div class="flex flex-col gap-3">
    <div class="flex gap-3 justify-between">
      <mat-paginator class="bg-white!"
                     (page)="handlePageEvent($event)"
                     [length]="products?.count"
                     [pageSize]="shopParams.pageSize"
                     [showFirstLastButtons]="true"
                     [pageSizeOptions]="pageSizeOptions"
                     [pageIndex]="shopParams.pageIndex - 1"
                     aria-label="Select page"></mat-paginator>
      <form class="flex w-full max-w-md mx-4"
            #searchForm="ngForm"
            (ngSubmit)="onSearchChange()">
        <input type="search" name="search" placeholder="Search"
               [(ngModel)]="shopParams.search"
               class="w-full grow h-4 p-5 rounded-s-lg border border-gray-500">
        <button mat-icon-button type="submit"
                class="h-4 py-5 border border-gray-500 rounded-e-lg!">
          <mat-icon>search</mat-icon>
        </button>
      </form>
      <div class="flex gap-3">
        <button mat-stroked-button
                (click)="openFiltersDialog()">
          <mat-icon>filter_list</mat-icon>
          Filters
        </button>
        <button mat-stroked-button
                [matMenuTriggerFor]="sortMenu">
          <mat-icon>swap_vert</mat-icon>
          Sort
        </button>
      </div>
    </div>
    <div class="grid grid-cols-5 gap-4">
      @for (product of products?.data; track product.id) {
        <app-product-item [product]="product"></app-product-item>
      }
    </div>
  </div>
</div>

<mat-menu #sortMenu="matMenu">
  <mat-selection-list [multiple]="false"
                      (selectionChange)="onSortChanged($event)">
    @for (sort of sortOptions; track $index) {
      <mat-list-option [value]="sort.value"
                       [selected]="shopParams.sort === sort.value">
        {{sort.name}}
      </mat-list-option>
    }
  </mat-selection-list>
</mat-menu>
